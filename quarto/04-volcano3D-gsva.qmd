# Volcano plots - GSVA - Between passages, Day 3

```{r}
#| include: False
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)
```

```{r}
#| include: False
here::i_am("quarto/04-volcano3D-gsva.qmd")

# Load packages
library(GSVA)
library(here)
library(tidyverse)
library(volcano3D)

# Load data for plotting
polar_manual_gsva <- readRDS(
  file <- here::here(
    "output",
    "data_enrichment",
    "GSVA",
    "polar_manual_gsva.RDS"
  )
)
```

```{r include=FALSE}
# Define plot specs
breaks_r <- seq(
  from = 0.5,
  to = 2.5,
  by = 1
)

breaks_z <- seq(
  from = 0,
  to = 40,
  by = 10
)

camera <- list(
  x = -1.05,
  y = 0.9,
  z = 0.375
)
```

## 3D volcano plot
```{r}
#| include: False
volcano3d <- map(
  polar_manual_gsva,
  \(polar_manual) {
    volcano3D(
      polar_manual,
      type = 1,
      grid_options = list(
        r_axis_ticks = breaks_r,
        z_axis_ticks = breaks_z
      ),
      label_size = 24,
      z_axis_title_size = 12,
      radial_axis_title_size = 12,
      camera_eye = camera
    )
  }
)
```

```{r}
volcano3d[[1]]
```

```{r}
volcano3d[[2]]
```

```{r}
volcano3d[[3]]
```

```{r}
volcano3d[[4]]
```

```{r}
volcano3d[[5]]
```

```{r}
volcano3d[[6]]
```

```{r}
volcano3d[[7]]
```

## Radial plots
```{r}
#| include: False
radial_plotly <- map(
  polar_manual_gsva,
  \(polar_manual) {
    radial_plotly(
      polar_manual,
      type = 1,
      r_axis_ticks = breaks_r
    )
  }
)
```

```{r}
radial_plotly[[1]]
```

```{r}
radial_plotly[[2]]
```

```{r}
radial_plotly[[3]]
```

```{r}
radial_plotly[[4]]
```

```{r}
radial_plotly[[5]]
```

```{r}
radial_plotly[[6]]
```

```{r}
radial_plotly[[7]]
```