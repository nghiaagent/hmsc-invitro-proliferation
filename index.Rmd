---
title: "hMSC Transcriptome Report"
author: "Mitchell Nguyen"
date: "`r Sys.Date()`"
output: bookdown::gitbook
documentclass: book
geometry: margin=2cm
biblio-style: apalike
link-citations: yes
bibliography: references.bib
---

# Preface

## Methods

### Exploratory analysis and QC


### Data exploration

Unsupervised clustering using multidimensional scaling (MDS) plots implemented in `Glimma` was used for data exploration. In this context, MDS reduces the dimensionality of our datasets from thousands of genes to a smaller number of dimensions. Here, each dimension is uncorrelated from each other, the first dimensions (dim1, dim2, etc.) are composed of the most highly variable genes in the dataset, and together, the dimensions retain most of the original datasetâ€™s variance. Additionally, expression heatmaps was used to summarise differential expression in the dataset. Heatmaps visualised only differentially expressed genes for clarity.

### Differential gene expression (DGE) analysis

The normalised transcriptome data was used to build a model in limma-voom [@ritchie2015] with the necessary experimental conditions (genotype, treatment) coded in the model matrix. The voomLmFit function in edgeR was used to convert RNA-seq counts to logCPM, estimate the mean-variance relationship in the dataset, and linear model fit . A contrast matrix was used to define desired comparisons between treatments and timepoints to discover differentially expressed genes (DEGs) for each comparison. Comparisons were made to [placeholder]. Genes with FDR \< 0.05 were considered as differentially expressed genes (DEGs).

#### Model matrix specifications

```{r echo=FALSE}

fit_contrasts <- readRDS(file.path("output",
                                   "data_expression",
                                   "post_DGE",
                                   "fit_contrasts.RDS"))

fit_contrasts[["design"]]
```

#### Contrast matrix specifications

```{r echo=FALSE}

fit_contrasts[["contrasts"]]
```

#### List of comparisons

### Visualisation of DEGs

#### Volcano plots

Volcano plots implemented in the Glimma package were used for visualising changes across the whole genome between 2 conditions, with the x-axis representing log-fold change between selected conditions and the y-axis representing $-log_{10}(p.value)$.

#### 3D volcano plots

3D cylindrical volcano plots implemented in the Volcano3D package (Lewis et al., 2019) were used for visualising changes across the whole genome between 3 conditions. In this plot, gene expression (as logCPM) was projected on to a two-dimensional polar coordinate system and coloured based on the condition where they were considered as significantly upregulated. The vertical axis represents $-log_{10}(p.value)$.

### Functional enrichment analysis

Functional enrichment analysis describes a class of bioinformatics methods that identifies biological functions significantly overrepresented in a list of genes. Multiple gene set databases are employed in this study to gauge a complete picture of biological changes across the experimental conditions. Information from these databases were used to determine functional enrichment by the camera algorithm [@wu2012].

#### Gene set databases

Table (x) lists the gene set databases used in our study. Two main databases utilised were MSigDB Hallmark and Gene Ontology. All gene sets were downloaded from the Broad Institute Molecular Signatures Database version 2023.2 as GMT files and imported to the R environment.

| Source        | DL from | Name                                  |
|---------------|---------|---------------------------------------|
| MSigDB        | MSigDB  | H:                                    |
| Gene Ontology | MSigDB  | C5/GO/BP: Biological Process ontology |
| Gene Ontology | MSigDB  | C5/GO/CC: Cellular Component ontology |
| Gene Ontology | MSigDB  | C5/GO/MF: Molecular Function ontology |

#### Correlation adjusted mean rank (camera) gene set enrichment analysis

A gene set enrichment-type analysis was performed using camera with the gene sets described above. This method was used to perform functional enrichment on gene lists derived directly from differential expression analysis, with the primary benefit of being able to detect functional enrichment when differential expression was not significant. Camera improves on previously implemented gene set enrichment analysis algorithms by correcting for inter-gene correlation to prevent false positives. The test was performed with the inter-gene correlation factor set to 0.01 (as suggested by the original authors); gene sets with FDR \< 0.05 were considered significantly enriched.
